# 2Dマインクラフト風ブラウザゲーム 要件定義書（MVP）

## 1. 背景・目的
- ブラウザ上で動作し、GitHub Pagesで公開可能なミニマルなサンドボックスゲームを提供する。
- 「マインクラフト」のコアである採掘・設置・探索の体験を2Dで手軽に再現し、拡張のベースとなる土台を整える。

## 2. 対象ユーザー
- ブラウザ環境で手軽に遊べるクラフト系ゲームを求めるライトユーザー。
- 開発メンバー自身が改造や機能追加を楽しむことを想定した技術検証用途。

## 3. ターゲットプラットフォーム
- PCブラウザ（最新のChrome / Edge / Firefox）。
- GitHub Pages上でホストしたURLからアクセスできること。
- スマートフォン対応はMVP範囲外。

## 4. スコープ
### 4.1 MVPで提供する要素
- 固定サイズ（画面1〜2枚程度）の2Dタイルマップ。
- プレイヤーキャラクターの表示・左右移動・ジャンプ・重力落下。
- ブロック破壊（採掘）・ブロック設置。
- ホットバー形式の簡易インベントリ（最大5スロット）。
- プレイヤーを中心にスクロールするカメラ。

### 4.2 MVPで対象外とする要素
- 敵キャラクター、NPC、AI挙動。
- 昼夜サイクルや天候変化。
- クラフトレシピ、ツール耐久度、複雑なインベントリ管理。
- サウンド（BGM・SE）、セーブデータ、マルチプレイ機能。

## 5. ゲーム概要
- プレイヤーは横スクロールのステージでブロックを採掘・設置しながら自由に地形を編集できる。
- ブロック種は `air` / `dirt` / `stone` / `wood` の4種類を基本とする。
- ホットバーから選択したブロックを設置し、破壊したブロックは自動でインベントリに加わる。

## 6. 機能要件
### 6.1 世界生成
- 16x16ピクセルのタイルを基本単位とする。
- ゲーム開始時に固定サイズ（例: 横64×縦32）の2D配列を生成。
- 地表ラインをシンプルなノイズまたは段差ルールで決定し、地下を`stone`、地表付近を`dirt`、地上の一部に`wood`を配置。
- 生成結果はゲーム開始ごとにリフレッシュされ、再現性は不要。

### 6.2 プレイヤー挙動
- キーボードの左右キー（またはA/D）で移動、Spaceキーでジャンプ。
- 重力は一定の加速度で適用し、接地時のみジャンプ可能。
- AABBベースの当たり判定でタイルにぶつかった場合に移動を制限する。

### 6.3 ブロック操作
- マウスカーソルに合わせてグリッド座標を算出し、プレイヤーの周囲1〜2マス以内のブロックに対して破壊・設置を行う。
- 左クリック：破壊（対象タイルが`air`以外のとき）→破壊結果をホットバーに追加。
- 右クリック：設置（ホットバーで選択中のブロックが存在するとき）。
- 破壊・設置の処理は即時完了とし、遅延やチャージは導入しない。

### 6.4 インベントリUI
- 画面下部にホットバー（5スロット）を表示。
- 数字キー（1〜5）でアクティブスロットを切り替え。
- 破壊したブロックは空きスロットに1個ずつ追加。スタック上限は当面気にしない。

### 6.5 カメラ・描画
- プレイヤーを画面中央付近に保持するスクロールカメラ。
- 背景は単色またはグラデーションのみ。パララックス背景は範囲外。
- タイルおよびプレイヤーは固定ドットのスプライトで描画。

### 6.6 UI/UX
- タイトル画面やポーズメニューは省略。ゲーム起動で即プレイ開始。
- 操作説明は画面内に簡易テキストで表示しても良いが必須ではない。

## 7. 非機能要件
- **技術スタック**: TypeScript / Vite / Phaser 3。
- **パフォーマンス**: PCブラウザで60fpsを目標（MVP時点では30fps以上を確保）。
- **ビルド**: `npm run build` で `dist/` に本番成果物を生成。
- **品質保証**: 手動テストで主要操作（移動・ジャンプ・破壊・設置）を検証。自動テストは任意。

## 8. 画面仕様
- キャンバス解像度：横 960px × 縦 540px を想定（レスポンシブ対応は範囲外）。
- UIレイアウト：画面下部中央にホットバー、プレイヤーは中央に表示。
- カラーパレット：8〜12色程度のレトロな配色（具体的な色指定はデザイナー裁量）。

## 9. 操作フロー
1. ブラウザでURLにアクセスすると即ゲームシーンが開始。
2. プレイヤーを左右に移動し、ジャンプで段差を越える。
3. マウス左クリックで近接ブロックを破壊→ホットバーに入る。
4. 数字キーでホットバーを切り替え、右クリックでブロックを設置。
5. Escキーでブラウザが提供する標準メニューに戻る（独自のポーズなし）。

## 10. 技術構成
- `src/main.ts`: Phaserゲーム初期化（ゲームサイズ、シーン登録）。
- `src/scenes/GameScene.ts`: 世界生成・プレイヤー制御・入力処理。
- `src/game/world.ts`: マップ生成とデータ管理（2D配列）。
- `src/game/player.ts`: プレイヤーの状態と物理処理。
- `src/game/inventory.ts`: ホットバーのデータ構造と更新。
- `src/ui/hotbar.ts`: ホットバー描画コンポーネント。
- `assets/tileset.png`: ブロック・プレイヤー用スプライトシート。
- Viteの標準構成を利用し、ESMでモジュールを管理。

## 11. GitHub Pages デプロイ要件
- GitHubリポジトリにソースコードを配置し、`main`ブランチで管理。
- GitHub Actions（公式 `deploy-pages` テンプレート）を使用し、`npm install` → `npm run build` → `dist/` を `gh-pages` ブランチにデプロイ。
- `dist/index.html` をエントリーポイントとし、Pages設定で `gh-pages` ブランチの `/` ディレクトリを指定。
- ルーティングは単一ページのため、`dist/404.html` に `index.html` をコピー（ハードリロード対策）。

## 12. 今後の拡張候補（MVP外）
- 昼夜サイクル、照明エフェクト。
- 敵/動物の追加、戦闘要素。
- 多段クラフト、レシピブック、ツール耐久度。
- サウンド、BGM、および設定メニュー。
- セーブ/ロード機能、ワールドサイズの拡張、シード指定。

## 13. マイルストーン（参考）
1. **セットアップ**（1日）：Vite + Phaserプロジェクト作成、ビルド・開発サーバ確認。
2. **コアゲームプレイ**（2〜3日）：マップ生成、プレイヤー移動・物理、ブロック破壊/設置。
3. **UI統合**（1日）：ホットバー実装、入力切り替え、簡易操作ガイド。
4. **仕上げ・デプロイ**（1日）：コード整理、ビルド確認、GitHub Pages デプロイ。

以上を満たすことで、MVPとしてプレイ可能な2DクラフトゲームをGitHub Pages上で公開できる。
